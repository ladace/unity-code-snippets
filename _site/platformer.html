<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Making a Platformer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Unity-code-snippets</h1>
      <h2 class="project-tagline"></h2>
      <a href="https://github.com/ladace/unity-code-snippets" class="btn">View on GitHub</a>
      <a href="https://github.com/ladace/unity-code-snippets/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/ladace/unity-code-snippets/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <large><a href="/unity-code-snippets/">Goto Home</a></large>
      <h1>Making a Platformer</h1>

<h2>Character Movement</h2>

<p>Attach it to the player, who must have a <code>Rigidbody2D</code> on it.</p>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">Player</span> <span class="p">:</span> <span class="n">MonoBehaviour</span> <span class="p">{</span>

    <span class="k">public</span> <span class="kt">float</span> <span class="n">speed</span><span class="p">;</span>

    <span class="k">void</span> <span class="nf">Update</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kt">float</span> <span class="n">oldY</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Rigidbody2D</span><span class="p">&gt;</span> <span class="p">().</span><span class="n">velocity</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
        <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Rigidbody2D</span><span class="p">&gt;().</span><span class="n">velocity</span> <span class="p">=</span>
            <span class="k">new</span> <span class="nf">Vector2</span><span class="p">(</span><span class="n">speed</span> <span class="p">*</span> <span class="n">Input</span><span class="p">.</span><span class="n">GetAxis</span> <span class="p">(</span><span class="s">&quot;Horizontal&quot;</span><span class="p">),</span> <span class="n">oldY</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3>Character Movement with Jumping</h3>

<p>Attach it to the player object, who must have a <code>Rigidbody2D</code> on it.</p>

<p>The player object should be set to a unique layer. Edit the <code>groundMask</code> and toggle every layer but the player layer.</p>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">Player</span> <span class="p">:</span> <span class="n">MonoBehaviour</span> <span class="p">{</span>

    <span class="k">public</span> <span class="kt">float</span> <span class="n">speed</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">float</span> <span class="n">jumpSpeed</span><span class="p">;</span>
    <span class="k">public</span> <span class="n">LayerMask</span> <span class="n">groundMask</span><span class="p">;</span>

    <span class="k">void</span> <span class="nf">Update</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kt">float</span> <span class="n">oldY</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Rigidbody2D</span><span class="p">&gt;</span> <span class="p">().</span><span class="n">velocity</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
        <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Rigidbody2D</span><span class="p">&gt;().</span><span class="n">velocity</span> <span class="p">=</span>
            <span class="k">new</span> <span class="nf">Vector2</span><span class="p">(</span><span class="n">speed</span> <span class="p">*</span> <span class="n">Input</span><span class="p">.</span><span class="n">GetAxis</span> <span class="p">(</span><span class="s">&quot;Horizontal&quot;</span><span class="p">),</span> <span class="n">oldY</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">Input</span><span class="p">.</span><span class="n">GetButtonDown</span> <span class="p">(</span><span class="s">&quot;Jump&quot;</span><span class="p">))</span> <span class="p">{</span>
            <span class="c1">// check if the player is on ground</span>
            <span class="n">BoxCollider2D</span> <span class="n">col</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">BoxCollider2D</span><span class="p">&gt;</span> <span class="p">();</span>
            <span class="n">Vector2</span> <span class="n">scale</span> <span class="p">=</span> <span class="n">transform</span><span class="p">.</span><span class="n">localScale</span><span class="p">;</span>
            <span class="n">RaycastHit2D</span> <span class="n">res</span> <span class="p">=</span> <span class="n">Physics2D</span><span class="p">.</span><span class="n">BoxCast</span> <span class="p">((</span><span class="n">Vector2</span><span class="p">)</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">+</span> <span class="n">Vector2</span><span class="p">.</span><span class="n">Scale</span> <span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="n">col</span><span class="p">.</span><span class="n">offset</span><span class="p">),</span> <span class="n">Vector2</span><span class="p">.</span><span class="n">Scale</span> <span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="n">col</span><span class="p">.</span><span class="n">size</span><span class="p">),</span>
                               <span class="n">transform</span><span class="p">.</span><span class="n">rotation</span><span class="p">.</span><span class="n">eulerAngles</span><span class="p">.</span><span class="n">z</span><span class="p">,</span> <span class="n">Vector2</span><span class="p">.</span><span class="n">down</span><span class="p">,</span> <span class="n">Mathf</span><span class="p">.</span><span class="n">Infinity</span><span class="p">,</span> <span class="n">groundMask</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">collider</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">&amp;&amp;</span> <span class="n">res</span><span class="p">.</span><span class="n">distance</span> <span class="p">&lt;=</span> <span class="m">0.02f</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// if the player is on ground</span>
                <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Rigidbody2D</span><span class="p">&gt;().</span><span class="n">velocity</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">speed</span> <span class="p">*</span> <span class="n">Input</span><span class="p">.</span><span class="n">GetAxis</span> <span class="p">(</span><span class="s">&quot;Horizontal&quot;</span><span class="p">),</span> <span class="n">jumpSpeed</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2>Spikes</h2>

<h3>Elementary</h3>

<p>Destroying the player object:</p>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">Lethal</span> <span class="p">:</span> <span class="n">MonoBehaviour</span> <span class="p">{</span>
    <span class="k">void</span> <span class="nf">OnTriggerEnter2D</span> <span class="p">(</span><span class="n">Collider2D</span> <span class="n">collider</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">collider</span><span class="p">.</span><span class="n">tag</span> <span class="p">==</span> <span class="s">&quot;Player&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">Destroy</span><span class="p">(</span><span class="n">collider</span><span class="p">.</span><span class="n">gameObject</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Or loading the loaded level</p>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">Lethal</span> <span class="p">:</span> <span class="n">MonoBehaviour</span> <span class="p">{</span>
    <span class="k">void</span> <span class="nf">OnTriggerEnter2D</span> <span class="p">(</span><span class="n">Collider2D</span> <span class="n">collider</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">collider</span><span class="p">.</span><span class="n">tag</span> <span class="p">==</span> <span class="s">&quot;Player&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">Application</span><span class="p">.</span><span class="n">LoadLevel</span><span class="p">(</span><span class="n">Application</span><span class="p">.</span><span class="n">loadedLevel</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Or loading the gameover screen.</p>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">Lethal</span> <span class="p">:</span> <span class="n">MonoBehaviour</span> <span class="p">{</span>
    <span class="k">void</span> <span class="nf">OnTriggerEnter2D</span> <span class="p">(</span><span class="n">Collider2D</span> <span class="n">collider</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">collider</span><span class="p">.</span><span class="n">tag</span> <span class="p">==</span> <span class="s">&quot;Player&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">Application</span><span class="p">.</span><span class="n">LoadLevel</span><span class="p">(</span><span class="s">&quot;GameOver&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/ladace/unity-code-snippets">Unity-code-snippets</a> is maintained by <a href="https://github.com/ladace">ladace</a>.</span>

        <span class="site-footer-credits"><a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
